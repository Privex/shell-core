language: bash

addons:
  apt:
    packages:
      - git
      - curl
      - shellcheck
  homebrew:
    packages:
      - gsed
      - gawk
      - ggrep
      - bash

jobs:
  include:
    - os: linux
      dist: xenial
    - os: linux
      dist: bionic
    - os: osx


before_script:
  - |
    if [[ "${TRAVIS_OS_NAME:-}" == 'osx' ]]; then
      echo "/usr/local/bin/bash" | sudo tee -a /etc/shells
      sudo chsh -s /usr/local/bin/bash -u $(whoami)
      echo "Real OSX bash version - $(bash --version)"
    fi
  - sudo chsh 
  - git clone -q https://github.com/bats-core/bats-core.git
  - sudo cp -R bats-core /usr/local/git-bats
  - pushd /usr/local/git-bats && sudo ./install.sh /usr/local/bats-core && popd

script:
  - /usr/local/bats-core/bin/bats -t tests.bats


